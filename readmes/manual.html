<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">



<title></title>

<script src="manual_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="manual_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="manual_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="manual_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="manual_files/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="manual_files/highlight/default.css"
      type="text/css" />
<script src="manual_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>




</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="manual_files/navigation-1.0/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">



</div>


<div id="count-data-distributions" class="section level1">
<h1>Count data distributions</h1>
<p>Parameters:</p>
<ul>
<li><span class="math">\(\lambda\)</span> - Poisson parameter (average number of foci per cell).<br /></li>
<li><span class="math">\(r\)</span> - zero inflation (fraction of cells treated by system as having no foci regardless of their real state)<br /></li>
<li><span class="math">\(\theta\)</span> - dispersion parameter.</li>
</ul>
<p>Usually the NB distribution is parametrized using <span class="math">\(\mu\)</span> and <span class="math">\(\theta\)</span>, but to make comparison clearer, we use <span class="math">\(\lambda\)</span> instead of <span class="math">\(\mu\)</span>. In this parametrization, NB and ZINB are treated as the mixture of Poisson and Gamma (<span class="math">\(\Gamma\)</span>) distributions.</p>
<table>
<thead>
<tr class="header">
<th align="left">Distribution name</th>
<th align="left">pmf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Poisson</td>
<td align="left"><span class="math">\[P\{X = k\} = \frac{\lambda^k \exp^{-\lambda}}{k!} \]</span></td>
</tr>
<tr class="even">
<td align="left">ZIP</td>
<td align="left"><span class="math">\[P\{X = k\} = \begin{cases} r + ( 1- r) \exp^{-\lambda},\text{if } k = 0\\ r \frac{\lambda^k \exp^{-\lambda}}{k!},\text{if } k = 1, 2, \ldots \end{cases} \]</span></td>
</tr>
<tr class="odd">
<td align="left">NB</td>
<td align="left"><span class="math">\[P\{X = k\} = \frac{\Gamma (\theta + k)}{\Gamma(\theta) k!}  \left(\left( \frac{\theta}{\theta + \lambda} \right)^\theta \left( \frac{\lambda}{\theta + \lambda} \right) \right)^k\]</span></td>
</tr>
<tr class="even">
<td align="left">ZINB</td>
<td align="left"><span class="math">\[P\{X = k\} = \begin{cases}r + (1 - r) \left( \frac{\theta}{\theta + \lambda} \right)^\theta,\text{if } k = 0\\(1 - r) \frac{\Gamma (\theta + k)}{\Gamma(\theta) k!}  \left(\left( \frac{\theta}{\theta + \lambda} \right)^\theta \left( \frac{\lambda}{\theta + \lambda} \right) \right)^k,\text{if } k = 1, 2, \ldots\end{cases}\]</span></td>
</tr>
</tbody>
</table>
<p>Poisson and Negative Binomial distributions have the same expected value. In case of ZIP and ZINB, the expected value is smaller than the real avarage number of foci per cell.</p>
<table>
<thead>
<tr class="header">
<th align="left">Distribution name</th>
<th align="left">Expected value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Poisson</td>
<td align="left"><span class="math">\[E(X) = \lambda \]</span></td>
</tr>
<tr class="even">
<td align="left">ZIP</td>
<td align="left"><span class="math">\[E(X) = (1 - r) \lambda \]</span></td>
</tr>
<tr class="odd">
<td align="left">NB</td>
<td align="left"><span class="math">\[E(X) = \lambda \]</span></td>
</tr>
<tr class="even">
<td align="left">ZINB</td>
<td align="left"><span class="math">\[E(X) = (1 - r)  \lambda \]</span> <!-- keep it here, because otherwise table parse oddly  --></td>
</tr>
</tbody>
</table>
<p>Depending on the value of <span class="math">\(r\)</span> the variance of ZIP and ZINB may be smaller or bigger than the variance of Poisson distribution. In case of the NB distribution, the variance is always bigger than for the Poisson distribution, although the difference becomes negligible, when the <span class="math">\(\theta\)</span> is much bigger than <span class="math">\(\lambda^2\)</span>.</p>
<table>
<thead>
<tr class="header">
<th align="left">Distribution name</th>
<th align="left">Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Poisson</td>
<td align="left"><span class="math">\[\textrm{var}(X) = \lambda \]</span></td>
</tr>
<tr class="even">
<td align="left">ZIP</td>
<td align="left"><span class="math">\[\textrm{var}(X) = \lambda (1 - r)(1 + \lambda r)\]</span></td>
</tr>
<tr class="odd">
<td align="left">NB</td>
<td align="left"><span class="math">\[\textrm{var}(X) = \lambda + \frac{\lambda^2}{\theta} \]</span></td>
</tr>
<tr class="even">
<td align="left">ZINB</td>
<td align="left"><span class="math">\[\textrm{var}(X) = (1 - r) \lambda \left( 1 + r\lambda  + \frac{1}{\theta} \right)\]</span></td>
</tr>
</tbody>
</table>
</div>
<div id="overdispersion" class="section level1">
<h1>Overdispersion</h1>
<p>One of the important features of the Poisson distribution is the equality of variance and expected value. Although count data should be Poisson-distributed, we often encounter overdispersed data set, when the variance is bigger then the mean. Three distributions included in countR: ZIP, NB and ZINB can model overdispersed counts.</p>
<p>Overdispersion may be caused by the increased variability of the counts, for example the counting algorithm under- and overcounts. In such situation the data might have negative binomial distribution. The other cause of overdispersion is called zero-inflation and occurrs in data set, where some factor introduced faultly zeros. That means that some counts, regardless of their real state, are treated as zeros. In this case, data has the ZIP distribution.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
